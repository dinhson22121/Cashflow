-- Bảng người dùng (User)
CREATE TABLE App_user (
    ID SERIAL PRIMARY KEY,
    Username VARCHAR(255) NOT NULL,
    Password VARCHAR(255) NOT NULL,
    Email VARCHAR(255) NOT NULL,
    FirstName VARCHAR(100) NOT NULL,
    LastName VARCHAR(100) NOT NULL,
    PhoneNumber VARCHAR(20),
    Role VARCHAR(50),
    ValidFlag INTEGER,
    CreatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

-- Bảng Địa chỉ (Address)
CREATE TABLE Address (
    ID SERIAL PRIMARY KEY,
    Street VARCHAR(255) NOT NULL,
    City VARCHAR(100) NOT NULL,
    State VARCHAR(100) NOT NULL,
    ZipCode VARCHAR(20) NOT NULL,
    ApartmentNumber INTEGER,
    Priorities INTEGER,
    ValidFlag INTEGER,
    CreatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

-- Bảng Liên kết Người dùng - Địa chỉ (User_Address)
CREATE TABLE User_Address (
    user_id INTEGER REFERENCES App_user(ID),
    address_id INTEGER REFERENCES Address(ID),
    PRIMARY KEY (user_id, address_id)
);

-- Bảng Đầu tư (Investments)
CREATE TABLE Investments (
    ID SERIAL PRIMARY KEY,
    Name VARCHAR(255) NOT NULL,
    InvestmentAmount NUMERIC NOT NULL,
    OwedAmount NUMERIC,
    InvestmentDate TIMESTAMP NOT NULL,
    InvestmentType VARCHAR(50) NOT NULL,
    UserID INTEGER REFERENCES App_user(ID),
    ValidFlag INTEGER,
    CreatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

-- Bảng Giao dịch (Transactions)
CREATE TABLE Transactions (
    ID SERIAL PRIMARY KEY,
    InvestmentID INTEGER REFERENCES Investments(ID),
    TransactionType VARCHAR(50) NOT NULL,
    TransactionDate TIMESTAMP NOT NULL,
    Amount NUMERIC NOT NULL,
    Note TEXT,
    ValidFlag INTEGER,
    CreatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

-- Bảng Thu Nhập (Income)
CREATE TABLE Income (
    ID SERIAL PRIMARY KEY,
    UserID INTEGER REFERENCES App_user(ID),
    IncomeType VARCHAR(50) NOT NULL,
    Amount NUMERIC NOT NULL,
    IncomeDate TIMESTAMP NOT NULL,
    ValidFlag INTEGER,
    CreatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

-- Bảng Lương (Salary)
CREATE TABLE Salary (
    ID SERIAL PRIMARY KEY,
    UserID INTEGER REFERENCES App_user(ID),
    Amount NUMERIC NOT NULL,
    SalaryDate TIMESTAMP NOT NULL,
    IncomeType VARCHAR(50) NOT NULL,
    ValidFlag INTEGER,
    CreatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

-- Bảng Khoản Vay (Loan)
CREATE TABLE Loan (
    ID SERIAL PRIMARY KEY,
    UserID INTEGER REFERENCES App_user(ID),
    LoanType VARCHAR(50) NOT NULL,
    Amount NUMERIC NOT NULL,
    LoanDate TIMESTAMP NOT NULL,
    InterestRate NUMERIC NOT NULL,
    DueDate TIMESTAMP,
    ValidFlag INTEGER,
    CreatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

-- Bảng Thiết lập Phân bổ (AllocationSetup)
CREATE TABLE AllocationSetup (
    ID SERIAL PRIMARY KEY,
    InvestmentType VARCHAR(50) NOT NULL,
    AllocationPercentage NUMERIC NOT NULL,
    UserID INTEGER REFERENCES App_user(ID),
    ValidFlag INTEGER,
    CreatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

-- Bảng Lịch Sử (History)
CREATE TABLE History (
    ID SERIAL PRIMARY KEY,
    App_user_id INTEGER,
    Activity_type VARCHAR(255),
    Description TEXT,
    Created_at TIMESTAMP
);
